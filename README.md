# CPP2Ruby
Translator from c/c++ to ruby

Intro
=====
1 . This is a full featured translator for c/c++ code to ruby, which covers all c/c++ syntax.
Actually it is a compiler, the ruby version of c/c++ compiler generated by cocoR. (Since cocoR doesn't generate ruby code, so I move my c-script compiler to this as a base compiler). It does preprocessor, so can parse all kinds of c/c++ macros. 
Then it does parsing and generate ruby code.  

But in most case, you can't run the generate ruby code just as same result as c/c++.  
You absolutely need do some manual work. This tool's goal is helping you do the 99% of job.  

2 . The is a very "soft" compiler. You can just translate part of your cpp project(e.g. one or two modules) without any error. This is useful when you work on a million-lines c/c++ project. You can do nice refactoring to ruby gradually,  module by module.

3 . You can extend this compile by define more macros to translate platform dependant api to ruby api.

Directory of this projects:<br>
1. All source of compiler is under root.<br> 
2. ./output: The ruby code generated from POJDT.c<br>
3. ./jdt: The testing rails project for generated ruby code<br>

How to translate your cpp to ruby:
===
1 . Download the project from https://github.com/jackieju/CPP2Ruby.git  

***You need install ruby version >= 1.9***

2 . Run translate.rb to do job  

        $ ruby translate.rb -d output POJDT.c POJDT1.c  

You don't need involve all files included by POJDT.c (which will leads to a hell), you just need to copy those file you really want them logic.<br>
So here I only want copy 3 file POJDT.c POJDT1.c and POJDT.h, and just declare those macros and class name that you don't want involve.<br>

3 . Declare macros and class dependency<br>
Before translation, you need <br>
1) Define some macro in c_macros.c<br>
e.g.
<pre>
	#define TRUE true
	#define FALSE false
	#define NULL nil
	#define _LOGMSG(a,b,c)
</pre>
2) Define all classes name referenced in your c/cpp file in c_classdefs.rb<br>
<pre>
$ar_classdefs = [
    "std",
    "SJournalKeys",
    "CBusinessObject",
    "PDAG",
...
    ]
</pre>
	When you encounter error while translating, please check the line and the perpetrator class and macro in above 2 steps.  
e.g. The error message is:
<pre>
41257|]...... SBOErr RecordHist (CBusinessObject& bizObject, PDAG dag);......
41257|]......~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~......
41257|]stack:(cr_parser.rb:327:in `GenError'
cr_parser.rb:250:in `Expect'
cp.rb:3695:in `FunctionCall'
cp.rb:1693:in `VarList'
</pre>
Then you need add "CBusinessObject" and "PDAG" into the array of file c_classdefs.rb
	
	
If you'v done translation successfully, you will see all ruby files under directory "output"

4 . You can define more macros in c_macros.c to extend this tranlate. 
This is very useful to translate platform dependant api to ruby api.  
e.g. You want to translate strlen(s) to ruby code s.size()
		#define strlen(s) s.size

Easy ? :)

